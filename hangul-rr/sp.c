/***********************************************************************************
 *                                                                                 *
 * https://en.wikipedia.org/wiki/Revised_Romanization_of_Korean#Special_provisions *
 *                                                                                 *
 * ㅇ ㄱ ㄴ ㄷ ㄹ ㅁ ㅂ ㅅ ㅈ  ㅊ ㅋ  ㅌ ㅍ  ㅎ                                           *
 * 11 0 2  3 5  6 7  9 12 14 15 16 17 18                                           *
 *                                                                                 *
 * ㄱ  1                                                                            *
 * ㄴ  4                                                                            *
 * ㄷ  7                                                                            *
 * ㄹ  8                                                                            *
 * ㅁ 16                                                                            *
 * ㅂ 17                                                                            *
 * ㅅ 19                                                                            *
 * ㅇ 21                                                                            *
 * ㅈ 22                                                                            *
 * ㅊ 23                                                                            *
 * ㅌ 25                                                                            *
 * ㅎ 27                                                                            *
 *                                                                                 *
 ***********************************************************************************
 */

#include <stddef.h>

#include "sp.h"

/* private */

#define _ NULL

static const SP sp[27+1][18+1] = {
  // reserve sp[0] for final consonant "0.none" splitted from the previous hangul
  // reserve sp[...][0] for consistency
  { },
  //    ______i11.                                                    _______i06m   _i07b                                             ______i18h
  { {}, {_ ,   "g"}, {       }, {"ng" , "n"}, {       }, {"ng" , "n"}, {"ng" , "m"}, {       }, {}, {        }, {}, {}, {       }, {}, {_ ,  "k"} },
  { {}, {         }, {       }, {          }, {       }, {"l"  , "l"}, {          }, {       }, {}, {        }, {}, {}, {       }, {}, {        } },
  { {}, {_ ,   "d"}, {       }, {"n"  , "n"}, {       }, {"n"  , "n"}, {"n"  , "m"}, {       }, {}, {        }, {}, {}, {       }, {}, {_ , "ch"} },
  { {}, {_ ,   "r"}, {       }, {          }, {       }, {"l"  , "l"}, {          }, {       }, {}, {        }, {}, {}, {       }, {}, {        } },
  { {}, {         }, {       }, {          }, {       }, {"m"  , "n"}, {          }, {       }, {}, {        }, {}, {}, {       }, {}, {        } },
  { {}, {_ ,   "b"}, {       }, {"m"  , "n"}, {       }, {"m"  , "n"}, {"m"  , "m"}, {       }, {}, {        }, {}, {}, {       }, {}, {_ ,  "p"} },
  { {}, {_ ,   "s"}, {       }, {"n"  , "n"}, {       }, {"n"  , "n"}, {"n"  , "m"}, {       }, {}, {        }, {}, {}, {       }, {}, {        } },
  { {}, {         }, {       }, {          }, {       }, {"ng" , "n"}, {          }, {       }, {}, {        }, {}, {}, {       }, {}, {        } },
  { {}, {_ ,   "j"}, {       }, {"n"  , "n"}, {       }, {"n"  , "n"}, {"n"  , "m"}, {       }, {}, {        }, {}, {}, {       }, {}, {_ , "ch"} },
  { {}, {_ ,  "ch"}, {       }, {"n"  , "n"}, {       }, {"n"  , "n"}, {"n"  , "m"}, {       }, {}, {        }, {}, {}, {       }, {}, {_ , "ch"} },
  { {}, {_ , "tch"}, {       }, {"n"  , "n"}, {       }, {"n"  , "n"}, {"n"  , "m"}, {       }, {}, {        }, {}, {}, {       }, {}, {_ , "ch"} },
  { {}, {_ ,   "h"}, {_ , "k"}, {"n"  , "n"}, {_ , "t"}, {"n"  , "n"}, {"n"  , "m"}, {_ , "p"}, {}, {_ , "ch"}, {}, {}, {_ , "t"}, {}, {_ ,  "t"} }
};

// https://gcc.gnu.org/onlinedocs/gcc/Designated-Inits.html
static const int lkrow[]={ [ 1]=1, [ 4]=2, [ 7]=3, [ 8]=4, [16]=5, [17]=6, [19]=7, [21]=8, [22]=9, [23]=10, [25]=11, [27]=12 };
static const int lkcol[]={ [11]=1, [ 0]=2, [ 2]=3, [ 3]=4, [ 5]=5, [ 6]=6, [ 7]=7, [ 9]=8, [12]=9, [14]=10, [15]=11, [16]=12, [17]=13, [18]=14};

/* public */

const SP *sp_lk(
  const int pe, // row    // previous  ending  // cFprev
  const int fi  // column // following initial // cI
){
  return &(sp[lkrow[pe]][lkcol[fi]]);
};
